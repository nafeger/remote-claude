# UX 개선 기능 시스템 테스트 가이드

## 개요

이 문서는 UX 개선 기능(PRD: 0003-prd-ux-improvements.md)의 시스템 테스트를 수행하기 위한 단계별 가이드입니다.

**테스트 환경:**
- 실제 Slack 워크스페이스
- Remote Claude 앱 설치 및 실행 중
- 테스트용 Slack 채널

**테스트 목표:**
- 인터랙티브 버튼 UI 동작 확인
- 한글 명령어 매핑 확인
- 실시간 진행 상황 업데이트 확인
- 대용량 출력 안정성 확인
- 50라인 출력 확인

## 사전 준비

### 1. Remote Claude 앱 실행 확인

```bash
# Remote Claude 앱이 실행 중인지 확인
ps aux | grep "node.*dist/index.js"

# 실행 중이 아니라면 시작
cd /Users/idongho/proj/remote-claude
npm start
```

### 2. Slack 채널 준비

- 테스트용 Slack 채널 생성 또는 기존 채널 사용
- Remote Claude 봇이 채널에 초대되었는지 확인

### 3. 테스트 프로젝트 준비

```bash
# 테스트용 프로젝트 디렉토리 생성 (이미 있으면 건너뛰기)
mkdir -p ~/test-remote-claude
cd ~/test-remote-claude

# 테스트 파일 생성
echo "console.log('test');" > index.js
mkdir -p logs
echo "Test log content" > logs/app.log
```

## 시스템 테스트 1: 인터랙티브 버튼으로 대화형 프롬프트 응답

**목표:** 9개 버튼(상태, 다운로드, 엔터, 엔터*2, 화살표 4개, 취소)이 모든 응답에 표시되고, Enter 및 화살표 키 전송이 정상 동작하는지 확인

### Step 1: 채널 설정 (Task 7.2)

**Slack에서 실행:**
```
/setup test-project ~/test-remote-claude
```

**예상 결과:**
- ✅ 설정 완료 메시지 표시
- ✅ 메시지 하단에 9개 버튼 표시:
  - 첫 번째 행: [📊 상태 확인] [📥 파일 다운로드] [❌ 취소]
  - 두 번째 행: [⏎ 엔터] [⏎⏎ 엔터*2] [↑] [↓] [←] [→]

**실제 결과:**
- [ ] 설정 완료 메시지 표시됨
- [ ] 9개 버튼 모두 표시됨

---

### Step 2: `/ask` 명령으로 대화형 프롬프트 발생 (Task 7.3)

**Slack에서 실행:**
```
/ask "Create a simple React component with a yes/no confirmation prompt"
```

**예상 결과:**
- ✅ "⏳ 작업을 시작합니다..." 메시지 및 9개 버튼 표시
- ✅ 5초마다 진행 상황 업데이트 메시지 및 9개 버튼 표시
- ✅ 최근 50라인 tmux 화면 출력 표시

**실제 결과:**
- [ ] 초기 메시지 및 버튼 표시됨 (Task 7.4)
- [ ] 5초마다 진행 상황 업데이트 발생
- [ ] 50라인 출력 표시됨

---

### Step 3: Claude Code 대화형 프롬프트 확인 (Task 7.5)

**예상 결과:**
- ✅ Claude Code가 "Do you want to proceed? [y/n]" 또는 유사한 질문 표시
- ✅ 봇이 진행 상황 업데이트 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 대화형 프롬프트 표시됨
- [ ] 버튼 표시됨

---

### Step 4: "⏎ 엔터" 버튼 클릭 (Task 7.6)

**Slack에서 실행:**
- "⏎ 엔터" 버튼 클릭

**예상 결과:**
- ✅ "✅ Enter 전송" 응답 메시지
- ✅ Claude Code가 Enter 입력을 받아 기본값(y)으로 진행
- ✅ 작업 계속 진행 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] Enter 전송 확인 메시지 표시됨 (Task 7.7)
- [ ] Claude Code가 계속 진행함

---

### Step 5: Claude Code 파일 선택 메뉴 확인 (Task 7.8)

**예상 결과:**
- ✅ Claude Code가 파일 선택 메뉴 표시 (↑↓로 선택 가능)
- ✅ 봇이 화면 출력 업데이트 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 파일 선택 메뉴 표시됨
- [ ] 버튼 표시됨

---

### Step 6: "↓" 버튼으로 메뉴 네비게이션 (Task 7.9)

**Slack에서 실행:**
- "↓" 버튼 2번 클릭

**예상 결과:**
- ✅ 각 클릭마다 "✅ ↓ 전송" 응답 메시지
- ✅ Claude Code 메뉴에서 선택 항목이 아래로 이동
- ✅ 화면 출력 업데이트 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 화살표 전송 확인 메시지 표시됨
- [ ] 메뉴 항목 이동 확인됨

---

### Step 7: "⏎ 엔터" 버튼으로 선택 확인 (Task 7.10)

**Slack에서 실행:**
- "⏎ 엔터" 버튼 클릭

**예상 결과:**
- ✅ "✅ Enter 전송" 응답 메시지
- ✅ Claude Code가 선택 항목 확인하고 작업 진행
- ✅ 작업 완료 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] Enter 전송 확인 메시지 표시됨 (Task 7.11)
- [ ] 작업 완료 메시지 표시됨

---

### 시스템 테스트 1 검증 (Task 7.12-7.16)

**검증 항목:**
- [ ] 모든 응답에 9개 버튼이 정상 표시됨
- [ ] Enter 키 전송이 정상 동작함
- [ ] 화살표 키 전송이 정상 동작함
- [ ] 대화형 프롬프트 응답이 성공함
- [ ] tmux 세션에서 키 입력이 확인됨

**추가 확인 (tmux에서):**
```bash
# tmux 세션 확인
tmux list-sessions

# tmux 세션 attach하여 Claude Code 화면 직접 확인
tmux attach -t test-project
# (Ctrl+B, D로 detach)
```

---

## 시스템 테스트 2: 명령어 실행 버튼 테스트

**목표:** "📊 상태 확인" 및 "📥 파일 다운로드" 버튼이 즉시 명령어를 실행하고, 모달 입력이 정상 동작하는지 확인

### Step 1: `/ask` 명령으로 작업 시작 (Task 7.17)

**Slack에서 실행:**
```
/ask "리팩토링 작업을 시작해주세요"
```

**예상 결과:**
- ✅ 초기 메시지 및 9개 버튼 표시
- ✅ 진행 상황 업데이트 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 메시지 및 버튼 표시됨 (Task 7.18)

---

### Step 2: "📊 상태 확인" 버튼 클릭 (Task 7.19)

**Slack에서 실행:**
- "📊 상태 확인" 버튼 클릭

**예상 결과:**
- ✅ 즉시 `/state` 명령어 실행
- ✅ 상태 정보 출력 (최근 50라인)
- ✅ 상태 정보 메시지에도 9개 버튼 표시

**실제 결과:**
- [ ] 상태 정보 출력됨 (Task 7.20)
- [ ] 50라인 출력됨
- [ ] 버튼 표시됨

---

### Step 3: "📥 파일 다운로드" 버튼 클릭 (Task 7.21)

**Slack에서 실행:**
- "📥 파일 다운로드" 버튼 클릭

**예상 결과:**
- ✅ 모달 입력 폼 표시
- ✅ 필드: "파일 경로" (Placeholder: "예: logs/app.log")

**실제 결과:**
- [ ] 모달 표시됨

---

### Step 4: 모달에 파일 경로 입력 및 제출 (Task 7.22-7.23)

**Slack 모달에서 실행:**
- 파일 경로 입력: `logs/app.log`
- Submit 버튼 클릭

**예상 결과:**
- ✅ 파일 다운로드 시작 메시지
- ✅ 파일이 Slack에 업로드됨
- ✅ 완료 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 파일 다운로드 완료 메시지 표시됨 (Task 7.24)
- [ ] 파일이 Slack에 업로드됨
- [ ] 버튼 표시됨

---

### 시스템 테스트 2 검증 (Task 7.25-7.28)

**검증 항목:**
- [ ] "📊 상태 확인" 버튼이 즉시 `/state` 실행함
- [ ] "📥 파일 다운로드" 버튼이 모달을 표시함
- [ ] 모달 제출로 파일 다운로드가 성공함
- [ ] 모든 단계에서 9개 버튼이 표시됨

---

## 시스템 테스트 3: 한글 명령어 + 버튼 통합 테스트

**목표:** 한글 명령어 매핑 및 "⏎⏎ 엔터*2" 버튼이 정상 동작하는지 확인

### Step 1: 한글 명령어로 파일 다운로드 (Task 7.29)

**Slack에서 실행 (한글 키보드 상태):**
```
/애쥐ㅐㅁㅇ logs/app.log
```
*참고: 영어 "download"를 한글 자판으로 입력한 것*

**예상 결과:**
- ✅ 명령어가 `/download logs/app.log`로 매핑됨
- ✅ 파일 다운로드 시작 메시지 및 9개 버튼 표시
- ✅ 파일이 Slack에 업로드됨
- ✅ 완료 메시지 및 9개 버튼 표시

**실제 결과:**
- [ ] 한글 명령어가 `/download`로 매핑됨 (Task 7.30)
- [ ] 파일 다운로드 완료됨 (Task 7.31)
- [ ] 버튼 표시됨

---

### Step 2: 한글 명령어로 상태 확인 (Task 7.32)

**Slack에서 실행 (한글 키보드 상태):**
```
/ㄴㅅㅁ션
```
*참고: 영어 "status"를 한글 자판으로 입력한 것 → `/state`로 매핑*

**예상 결과:**
- ✅ 명령어가 `/state`로 매핑됨
- ✅ 상태 정보 출력 (50라인) 및 9개 버튼 표시

**실제 결과:**
- [ ] 상태 정보 출력됨 (Task 7.33)
- [ ] 50라인 출력됨
- [ ] 버튼 표시됨

---

### Step 3: "⏎⏎ 엔터*2" 버튼 테스트 (Task 7.34-7.36)

**준비:**
- Claude Code에서 연속 줄바꿈이 필요한 프롬프트가 표시될 때까지 대기
- 또는 `/ask` 명령으로 멀티라인 입력이 필요한 작업 요청

**Slack에서 실행:**
- "⏎⏎ 엔터*2" 버튼 클릭

**예상 결과:**
- ✅ "✅ Enter*2 전송" 응답 메시지
- ✅ tmux 세션에 Enter 키가 2번 연속 전송됨
- ✅ Claude Code가 연속 Enter 입력을 받아 처리

**실제 결과:**
- [ ] Enter*2 전송 확인 메시지 표시됨
- [ ] 연속 Enter가 전송됨
- [ ] Claude Code가 프롬프트 종료함

---

### 시스템 테스트 3 검증 (Task 7.37-7.39)

**검증 항목:**
- [ ] 한글 명령어가 정상적으로 매핑됨 (`/ㄴㅅㅁ션` → `/state`, `/애쥐ㅐㅁㅇ` → `/download`)
- [ ] "⏎⏎ 엔터*2" 버튼으로 연속 Enter 전송이 성공함
- [ ] 모든 응답에 9개 버튼이 표시됨

---

## 테스트 결과 종합 (Task 7.40)

### 테스트 통과 기준

**모든 다음 항목이 "통과"여야 함:**
1. ✅ 모든 응답에 9개 버튼이 정상 표시됨
2. ✅ "⏎ 엔터" 버튼으로 Enter 키 전송 성공
3. ✅ "⏎⏎ 엔터*2" 버튼으로 Enter 2번 전송 성공
4. ✅ 화살표 버튼(↑↓←→)으로 키 전송 성공
5. ✅ "📊 상태 확인" 버튼으로 즉시 `/state` 실행 성공
6. ✅ "📥 파일 다운로드" 버튼으로 모달 표시 및 파일 다운로드 성공
7. ✅ 한글 명령어 매핑 정상 동작 (`/ㄴㅅㅁ션`, `/애쥐ㅐㅁㅇ`)
8. ✅ 실시간 진행 상황 업데이트 (5초 주기)
9. ✅ 50라인 출력 표시

### 테스트 결과 문서화

테스트 완료 후 다음 정보를 기록:

```markdown
# 시스템 테스트 결과

**테스트 일시:** YYYY-MM-DD HH:MM
**테스트 환경:** Slack 워크스페이스명
**테스트 채널:** #채널명

## 테스트 결과 요약

| 시나리오 | 상태 | 비고 |
|---------|------|------|
| 시스템 테스트 1: 인터랙티브 버튼 | ✅ PASS / ❌ FAIL | [상세 내용] |
| 시스템 테스트 2: 명령어 실행 버튼 | ✅ PASS / ❌ FAIL | [상세 내용] |
| 시스템 테스트 3: 한글 명령어 + 버튼 | ✅ PASS / ❌ FAIL | [상세 내용] |

## 발견된 이슈

[이슈가 있다면 여기에 기록]

## 스크린샷

[Slack 화면 캡처 첨부]
```

---

## 문제 발생 시 대응

### 버튼이 표시되지 않는 경우

1. Slack App의 Interactivity 설정 확인
2. `src/bot/formatters.ts`의 `addInteractiveButtons()` 함수 확인
3. Remote Claude 앱 재시작

### 버튼 클릭이 동작하지 않는 경우

1. Slack App의 Interactive Components 설정 확인
2. `src/index.ts`의 버튼 액션 리스너 등록 확인
3. Remote Claude 로그 확인:
   ```bash
   # 로그 확인
   tail -f /Users/idongho/proj/remote-claude/logs/app.log
   ```

### 한글 명령어가 매핑되지 않는 경우

1. `src/index.ts`에서 한글 명령어 리스너 등록 확인
2. `src/utils/korean-mapper.ts`의 매핑 테이블 확인
3. Slack에서 슬래시 커맨드가 등록되었는지 확인

### 키 전송이 동작하지 않는 경우

1. tmux 세션이 정상적으로 실행 중인지 확인:
   ```bash
   tmux list-sessions
   ```
2. `src/tmux/executor.ts`의 `sendArrowKey()`, `sendEnter()` 메서드 확인
3. tmux 세션에 attach하여 키 입력 직접 확인

---

## 다음 단계

모든 시스템 테스트가 통과하면:
1. Task List의 Task 7.0 완료 체크
2. README.md 업데이트
3. Git 커밋 및 PR 생성
4. v0.3.0 태그 생성
